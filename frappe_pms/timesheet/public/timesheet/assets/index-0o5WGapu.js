import{d as R,u as W,a as q,r as o,t as z,e as G,v as w,w as J,x as K,p as Q,y as b,z as U,g as y,q as N,D as k,E as Y,j as e,B as u,T as d,i as V,F as C,G as X,H as Z,I as ee,J as ae,K as se,L as te,M as le,N as re,m as ne,O as oe}from"./index-C1dL3-sP.js";import{S as ce,I as ie,C as me,a as de,T as he,b as ue,c as T,d as E,i as D,e as xe,f as _}from"./input-CYSuPJFJ.js";import{u as pe}from"./queryParam-CcAovJGT.js";const ve=()=>{var p,g,f,j,v;const{toast:$}=R(),a=W(s=>s.home),t=q(),[m,M]=pe("employee-name",""),[F,A]=o.useState(m),S=z(),{data:n,error:h,mutate:I,isLoading:L}=G("timesheet_enhancer.api.team.get_compact_view_data",{date:a.weekDate,employee_name:a.employeeName,page_length:20,start:a.start});o.useEffect(()=>{if(a.isFetchAgain&&(I(),t(w(!1))),n&&(Object.keys(a.data.data).length>0?t(J(n.message)):t(K(n.message))),h){const s=Q(h);$({variant:"destructive",description:s})}},[n,a.isFetchAgain,h]),o.useEffect(()=>{m!==""&&t(b(m))},[t,m]);const x=o.useCallback(U(s=>{t(b(s.target.value)),M(s.target.value)},1e3),[t]),H=o.useCallback(s=>{A(s.target.value),x(s)},[x]),O=o.useCallback(()=>{const s=y(N(a.weekDate,-14));t(k(s))},[t,a.weekDate]),B=o.useCallback(()=>{const s=y(N(a.weekDate,14));t(k(s))},[t,a.weekDate]),P=o.useCallback(()=>{a.hasMore&&(t(Y(a.start+20)),t(w(!0)))},[t,a.hasMore,a.start]);return L?e.jsx(ce,{isFull:!0}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{id:"filter-section",className:"flex gap-x-3 mb-3",children:[e.jsx("div",{className:"pr-4 max-w-sm w-full",children:e.jsx(ie,{placeholder:"Employee name",value:F,className:"placeholder:text-slate-400 focus-visible:ring-1 focus-visible:ring-slate-800 max-w-sm",onChange:H})}),e.jsxs("div",{className:"w-full flex",children:[e.jsxs("div",{className:"grow flex items-center w-full",children:[e.jsx(u,{variant:"outline",className:"p-1 h-fit",onClick:O,children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx(d,{className:"w-full text-center",variant:"h6",children:a.data.dates.length>0&&a.data.dates[0].key})]}),e.jsxs("div",{className:"grow flex items-center w-full",children:[e.jsx(d,{className:"w-full text-center",variant:"h6",children:a.data.dates.length>0&&a.data.dates[1].key}),e.jsx(u,{variant:"outline",className:"p-1 h-fit",onClick:B,children:e.jsx(de,{className:"w-4 h-4"})})]})]})]}),e.jsx("div",{className:"overflow-y-scroll mb-2",style:{height:"calc(100vh - 8rem)"},children:e.jsxs(he,{children:[e.jsx(ue,{children:e.jsxs(T,{children:[e.jsx(E,{className:"max-w-sm w-full"}),(g=(p=a.data)==null?void 0:p.dates)==null?void 0:g.map((s,l)=>s.dates.map(c=>{const i=V(c);return e.jsx(E,{className:C("text-slate-600 font-medium max-w-20 ",l!=0&&"bg-slate-200",D(c)&&"bg-slate-300"),children:i.day},`${l}-${c}`)}))]})}),e.jsx(xe,{children:Object.entries((f=a.data)==null?void 0:f.data).map(([s,l])=>e.jsxs(T,{children:[e.jsx(_,{className:"flex items-center gap-x-2 max-w-sm w-full",children:e.jsxs("span",{className:"flex gap-x-2 items-center font-normal hover:underline hover:cursor-pointer w-full",onClick:()=>{S(`${X}${Z}/${l.name}`)},children:[e.jsxs(ee,{className:"w-6 h-6",children:[e.jsx(ae,{src:decodeURIComponent(l.image),alt:l.employee_name}),e.jsx(se,{children:l.employee_name[0]})]}),e.jsx(d,{variant:"p",className:"w-full text-left text-ellipsis whitespace-nowrap overflow-hidden ",children:l.employee_name})]})}),l.data.map((r,c)=>{const i=te(r.hour,l.working_hour,l.working_frequency);return e.jsx(le,{delayDuration:0,children:e.jsx(re,{asChild:!0,children:e.jsxs(_,{className:C("text-xs hover:cursor-pointer bg-transparent",i==2&&"bg-warning/40",i==1&&"bg-success/20",i==0&&r.hour!=0&&"bg-destructive/10",r.is_leave&&"bg-warning/20",D(r.date)&&"bg-slate-50",r.hour==0&&"text-center"),children:[r.hour>0?ne(r.hour):"-",r.note&&e.jsx(oe,{className:"text-left whitespace-pre",children:r.note})]},`${s}-${c}`)})},`${r.hour}-id-${Math.random()}`)})]},s))})]})}),e.jsxs("div",{className:"w-full flex justify-between items-center",children:[e.jsx(u,{variant:"outline",onClick:P,disabled:!a.hasMore,children:"Load More"}),e.jsx(d,{variant:"p",className:"px-5 font-semibold",children:`${Object.keys((j=n==null?void 0:n.message)==null?void 0:j.data).length|0} of ${((v=n==null?void 0:n.message)==null?void 0:v.total_count)|0}`})]})]})};export{ve as default};
